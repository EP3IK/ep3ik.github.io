<!doctype html>
<html>

<body>

  <div>
    <video id="video" width="300" height="200" style="border: 1px solid gray"></video>
  </div>

  <label>Result:</label>
  <pre><code id="result"></code></pre>

  <script type="text/javascript" src="https://unpkg.com/@zxing/library@latest"></script>
  <script type="text/javascript">
    const decodeOnce = async (codeReader, selectedDeviceId) => {
      let result = await codeReader.decodeFromInputVideoDevice(selectedDeviceId, 'video');
      console.log(result)
      document.querySelector('#result').textContent = result.text
      // codeReader.decodeFromInputVideoDevice(selectedDeviceId, 'video').then((result) => {
      //   console.log(result)
      //   document.querySelector('#result').textContent = result.text
      // }).catch((err) => {
      //   console.error(err)
      //   document.querySelector('#result').textContent = err
      // })
    }

    window.addEventListener('load', async () => {
      // init
      const codeReader = new ZXing.BrowserQRCodeReader()
      console.log('ZXing code reader initialized')

      let videoInputDevices = await codeReader.getVideoInputDevices();
      let selectedDeviceId = videoInputDevices[0].deviceId;

      if (videoInputDevices.length >= 1) {
        await decodeOnce(codeReader, selectedDeviceId);
      }
    })
  </script>

</body>

</html>
